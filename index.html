<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Giants GPT</title>

<!-- Favicon / Home screen -->
<link rel="icon" href="https://i.pinimg.com/originals/0e/68/ed/0e68eda6243faa5f754b1cfb2b04846d.png" type="image/png">
<link rel="apple-touch-icon" href="https://i.pinimg.com/originals/0e/68/ed/0e68eda6243faa5f754b1cfb2b04846d.png">
<meta name="apple-mobile-web-app-capable" content="yes" />

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Segoe UI', Tahoma, sans-serif; background:#f5f5f5; color:#333; }
.dark body { background:#121212; color:#eee; }

#headerImg {
  padding: 12px 20px;
  background: #000;
  color: #fff;
  font-size: 20px;
  text-align: center;
  border-radius: 8px;
}
#headerImg img { height:40px; vertical-align: middle; margin-right:10px; }
#headerImg span { vertical-align:middle; font-weight:bold; }

#historyToggleWrap { text-align:right; margin: 10px; }
#historyToggleWrap button {
  background:#FD5A1E; color:white;
  border:none; padding:8px 14px; border-radius:6px;
  cursor:pointer;
}

#main { display:flex; height:calc(100vh - 160px); overflow:hidden; margin-top:10px; }

#historyDrawer {
  width: 260px; max-width: 80vw;
  background:#fff;
  border-right:1px solid #FD5A1E;
  box-shadow: 2px 0 8px rgba(0,0,0,0.2);
  transform: translateX(-100%);
  transition: transform 0.3s ease-in-out;
  padding: 20px; overflow-y:auto; border-radius:8px 0 0 8px;
}
#historyDrawer.open {
  transform: translateX(0);
}
#historyDrawer.dark { background:#1e1e1e; color:#eee; }
#historyDrawer h3 { margin-bottom:10px; color:#FD5A1E; }
#historyDrawer ul { list-style:none; margin:0; padding:0; }
#historyDrawer li { padding:8px; margin-bottom:6px; background:#f0f0f0; border-radius:6px; cursor:pointer; }
#historyDrawer li:hover { background:#FD5A1E; color:#fff; }

#historyDrawer button {
  width:100%; margin-top:8px; padding:8px;
  background:#FD5A1E; color:#fff; border:none; border-radius:6px;
}

#container {
  flex:1; display:flex; flex-direction:column; padding:10px;
}

#chat {
  flex:1; overflow-y:auto; background:#fafafa;
  border:1px solid #ccc; border-radius:10px;
  padding:10px; margin-bottom:10px;
}
.dark #chat { background:#1e1e1e; border-color:#333; }

.message { margin:8px 0; padding:10px 14px; border-radius:18px; max-width:75%; }
.user { background:#FD5A1E; color:white; margin-left:auto; }
.assistant { background:white; color:black; }
.dark .assistant { background:#333; color:white; }

textarea, input, select {
  width:100%; padding:10px; border-radius:8px; margin-top:5px; border:1px solid #ccc;
}
button.action { background:#FD5A1E; color:white; border:none; padding:10px; border-radius:8px; margin-top:5px; cursor:pointer; width:48%; }
button.action:hover { background:#e04f1a; }

#btnRow { display:flex; gap:4%; flex-wrap:wrap; }

@media(max-width:768px){
  #btnRow button { width:48%; }
  #main { flex-direction:column; }
  #historyDrawer { width:100%; max-height:50vh; border-right:none; border-bottom:2px solid #FD5A1E; }
}
</style>
</head>
<body>

<div id="headerImg">
  <img src="https://i.pinimg.com/originals/0e/68/ed/0e68eda6243faa5f754b1cfb2b04846d.png" alt="Logo" />
  <span>âš¾ Giants GPT</span>
</div>

<div id="historyToggleWrap"><button onclick="toggleHistory()">History</button></div>

<div id="main">
  <div id="historyDrawer" class="dark">
    <h3>Previous Chats</h3>
    <ul id="historyList"></ul>
    <button onclick="newChat()">New Chat</button>
  </div>

  <div id="container">
    <label>API Key: <input type="password" id="apiKey" placeholder="Your OpenAI API key"></label>
    <label>Current Chat Name: <input type="text" id="currentChatName" placeholder="Chat title..."></label>

    <label>Model:
      <select id="modelSelect">
        <option value="gpt-5">GPT-5</option>
        <option value="gpt-4o">GPT-4o</option>
        <option value="gpt-3.5-turbo">GPT-3.5</option>
      </select>
    </label>

    <label>Image Size:
      <select id="imageSizeSelect">
        <option>256x256</option>
        <option selected>512x512</option>
        <option>1024x1024</option>
      </select>
    </label>

    <label><input type="checkbox" id="darkToggle"> Dark Mode</label>

    <div id="chat"></div>

    <textarea id="userInput" placeholder="Type here..."></textarea>
    <div id="btnRow">
      <button class="action" id="sendBtn">Send</button>
      <button class="action" id="imageBtn">Generate Image</button>
    </div>
  </div>
</div>

<script>
const apiKeyInput = document.getElementById("apiKey");
const modelSelect = document.getElementById("modelSelect");
const chatDiv = document.getElementById("chat");
const userInput = document.getElementById("userInput");
const darkToggle = document.getElementById("darkToggle");
const historyList = document.getElementById("historyList");
const imageSizeSelect = document.getElementById("imageSizeSelect");
const sendBtn = document.getElementById("sendBtn");
const imageBtn = document.getElementById("imageBtn");
const currentChatNameInput = document.getElementById("currentChatName");
const historyDrawer = document.getElementById("historyDrawer");

const costPerThousandTokens = { 'gpt-3.5-turbo':0.0004, 'gpt-4o':0.003, 'gpt-5':0.005 }

let chatHistory = JSON.parse(localStorage.getItem("chatHistory")||"[]");
let currentChat = [];
let currentChatName = "";

function toggleHistory() { historyDrawer.classList.toggle("open"); }

function addMsg(role,text,isImage=false,imgUrl=""){
  const div=document.createElement("div");
  div.className="message "+(role==="user"?"user":"assistant");
  if(isImage){
    const img=document.createElement("img");
    img.src=imgUrl; img.style.maxWidth="100%"; img.style.borderRadius="6px";
    div.appendChild(img);
  } else { div.innerHTML=text.replace(/\n/g,"<br>"); }
  chatDiv.appendChild(div);
  chatDiv.scrollTop=chatDiv.scrollHeight;
  currentChat.push({role,text,isImage,imgUrl});
}

function sendMessage(){
  const key = apiKeyInput.value.trim();
  const content = userInput.value.trim();
  if(!key||!content) return;

  addMsg("user",content);
  userInput.value="";

  fetch("https://api.openai.com/v1/chat/completions",{
    method:"POST",
    headers:{ "Content-Type":"application/json","Authorization":"Bearer "+key},
    body:JSON.stringify({
      model:modelSelect.value,
      messages:[{role:"user",content}]
    })
  })
  .then(res=>res.json())
  .then(data=>{
    if(data.error) {
      addMsg("assistant","Error: "+data.error.message);
      return;
    }
    const reply = data.choices[0]?.message?.content;
    addMsg("assistant",reply || "(no response)");
  })
  .catch(err=> addMsg("assistant","Error: "+err.message));
}

function generateImage(){
  const key=apiKeyInput.value.trim();
  const prompt=userInput.value.trim();
  if(!key||!prompt) return;

  addMsg("user",prompt);
  userInput.value="";

  fetch("https://api.openai.com/v1/images/generations",{
    method:"POST",
    headers:{ "Content-Type":"application/json","Authorization":"Bearer "+key},
    body:JSON.stringify({
      model:"gpt-image-1",
      prompt:prompt,
      n:1,
      size:imageSizeSelect.value
    })
  })
  .then(res=>res.json())
  .then(data=>{
    if(!data.data || !data.data[0]) {
      addMsg("assistant","Image generation error");
      return;
    }
    const url=data.data[0].url;
    addMsg("assistant","",true,url);
  })
  .catch(err=> addMsg("assistant","Error: "+err.message));
}

function renderHistory(){
  historyList.innerHTML="";
  chatHistory.forEach((chat,index)=>{
    const li=document.createElement("li");
    li.textContent=chat.name;
    li.onclick=()=>{
      currentChat=chat.messages;
      currentChatName=chat.name;
      currentChatNameInput.value=currentChatName;
      chatDiv.innerHTML="";
      currentChat.forEach(m=> addMsg(m.role,m.text,m.isImage,m.imgUrl));
      historyDrawer.classList.remove("open");
    };
    historyList.appendChild(li);
  });
}

function newChat(){
  if(currentChat.length>0){
    if(!currentChatName){
      currentChatName = currentChat[0].text.slice(0,20)+"...";
    }
    chatHistory.push({name: currentChatName, messages: currentChat});
    localStorage.setItem("chatHistory",JSON.stringify(chatHistory));
    renderHistory();
  }
  chatDiv.innerHTML="";
  currentChat=[];
  currentChatName="";
  currentChatNameInput.value="";
}

// Save chat name as user edits
currentChatNameInput.addEventListener("input",()=>{
  currentChatName=currentChatNameInput.value;
});

// Theme & Settings
darkToggle.addEventListener("change",()=>{
  document.body.classList.toggle("dark");
  historyDrawer.classList.toggle("dark");
});

window.onload = ()=> renderHistory();

sendBtn.onclick = sendMessage;
imageBtn.onclick = generateImage;
userInput.addEventListener("keydown",(e)=>{ if(e.key==="Enter" && !e.shiftKey){ e.preventDefault(); sendMessage(); }});
</script>
</body>
</html>
